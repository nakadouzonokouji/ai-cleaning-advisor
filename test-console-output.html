<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #output { 
            background: #1a1a1a; 
            color: #00ff00; 
            padding: 20px; 
            height: 500px; 
            overflow-y: auto; 
            font-family: monospace; 
            white-space: pre-wrap;
            border-radius: 5px;
        }
        .button { 
            background: #007bff; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            margin: 5px; 
            border-radius: 3px; 
            cursor: pointer; 
        }
        .button:hover { background: #0056b3; }
        .clear { background: #dc3545; }
        .clear:hover { background: #c82333; }
    </style>
</head>
<body>
    <h1>ğŸ” AIæƒé™¤ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›ãƒ†ã‚¹ãƒˆ</h1>
    
    <div>
        <button class="button" onclick="location.href='http://localhost:8090/index.html'">ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚’é–‹ã</button>
        <button class="button" onclick="captureConsole()">ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚­ãƒ£ãƒ—ãƒãƒ£é–‹å§‹</button>
        <button class="button clear" onclick="clearOutput()">ã‚¯ãƒªã‚¢</button>
    </div>
    
    <div id="output"></div>

    <script>
        const output = document.getElementById('output');
        let isCapturing = false;
        
        function captureConsole() {
            if (isCapturing) return;
            isCapturing = true;
            
            const originalLog = console.log;
            const originalWarn = console.warn;
            const originalError = console.error;
            
            console.log = function(...args) {
                originalLog.apply(console, args);
                addToOutput('[LOG] ' + args.join(' '));
            };
            
            console.warn = function(...args) {
                originalWarn.apply(console, args);
                addToOutput('[WARN] ' + args.join(' '));
            };
            
            console.error = function(...args) {
                originalError.apply(console, args);
                addToOutput('[ERROR] ' + args.join(' '));
            };
            
            addToOutput('ğŸ“¡ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚­ãƒ£ãƒ—ãƒãƒ£é–‹å§‹');
            
            // ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®JavaScriptã‚’å®Ÿè¡Œ
            loadMainPage();
        }
        
        function addToOutput(message) {
            const timestamp = new Date().toLocaleTimeString();
            output.textContent += `[${timestamp}] ${message}\n`;
            output.scrollTop = output.scrollHeight;
        }
        
        function clearOutput() {
            output.textContent = '';
        }
        
        async function loadMainPage() {
            try {
                addToOutput('ğŸš€ ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿é–‹å§‹');
                
                // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿ã‚’ãƒ†ã‚¹ãƒˆ
                const productsModule = await import('./js/config/products.js');
                const dirtMappingModule = await import('./js/config/dirt-mapping.js');
                const locationsModule = await import('./js/config/locations.js');
                
                addToOutput('ğŸ“¦ ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿ç¢ºèª:');
                addToOutput('  productsModule: ' + (productsModule ? 'OK' : 'FAIL'));
                addToOutput('  dirtMappingModule: ' + (dirtMappingModule ? 'OK' : 'FAIL'));
                addToOutput('  locationsModule: ' + (locationsModule ? 'OK' : 'FAIL'));
                
                // ãƒ‡ãƒ¼ã‚¿åˆ†è§£ãƒ†ã‚¹ãƒˆ
                const { COMPREHENSIVE_CLEANING_PRODUCTS, DIRT_TYPE_MAPPING, LOCATION_PRODUCTS, COMPREHENSIVE_PRODUCT_DATABASE } = productsModule.default || productsModule;
                const { COMPREHENSIVE_DIRT_MAPPING } = dirtMappingModule.default || dirtMappingModule;
                const COMPREHENSIVE_LOCATION_CONFIG = locationsModule.default;
                
                addToOutput('ğŸ“Š åˆ†è§£å¾Œãƒ‡ãƒ¼ã‚¿ç¢ºèª:');
                addToOutput('  COMPREHENSIVE_CLEANING_PRODUCTS: ' + Object.keys(COMPREHENSIVE_CLEANING_PRODUCTS || {}).length + ' ã‚«ãƒ†ã‚´ãƒª');
                addToOutput('  COMPREHENSIVE_PRODUCT_DATABASE: ' + Object.keys(COMPREHENSIVE_PRODUCT_DATABASE || {}).length + ' ã‚«ãƒ†ã‚´ãƒª');
                addToOutput('  COMPREHENSIVE_DIRT_MAPPING: ' + Object.keys(COMPREHENSIVE_DIRT_MAPPING || {}).length + ' æ±šã‚Œã‚¿ã‚¤ãƒ—');
                addToOutput('  COMPREHENSIVE_LOCATION_CONFIG: ' + Object.keys(COMPREHENSIVE_LOCATION_CONFIG || {}).length + ' å ´æ‰€');
                addToOutput('  DIRT_TYPE_MAPPING: ' + Object.keys(DIRT_TYPE_MAPPING || {}).length + ' ãƒãƒƒãƒ”ãƒ³ã‚°');
                addToOutput('  LOCATION_PRODUCTS: ' + Object.keys(LOCATION_PRODUCTS || {}).length + ' å ´æ‰€åˆ¥å•†å“');
                
                // å•†å“ç·æ•°ã‚«ã‚¦ãƒ³ãƒˆ
                let totalProducts = 0;
                Object.values(COMPREHENSIVE_CLEANING_PRODUCTS || {}).forEach(category => {
                    if (category.products && Array.isArray(category.products)) {
                        totalProducts += category.products.length;
                        addToOutput(`    ${category.category || 'ä¸æ˜'}: ${category.products.length}ä»¶`);
                    }
                });
                addToOutput('ğŸ“Š ç·å•†å“æ•°: ' + totalProducts + 'ä»¶');
                
                // ã‚·ã‚¹ãƒ†ãƒ ãƒã‚§ãƒƒã‚¯
                const systemCheck = {
                    productsLoaded: Object.keys(COMPREHENSIVE_CLEANING_PRODUCTS || {}).length >= 5,
                    dirtMappingLoaded: Object.keys(COMPREHENSIVE_DIRT_MAPPING || {}).length >= 15,
                    locationsLoaded: Object.keys(COMPREHENSIVE_LOCATION_CONFIG || {}).length >= 7,
                    sufficientProducts: totalProducts > 50
                };
                
                addToOutput('ğŸ” ã‚·ã‚¹ãƒ†ãƒ ãƒã‚§ãƒƒã‚¯çµæœ:');
                Object.entries(systemCheck).forEach(([key, value]) => {
                    addToOutput(`  ${value ? 'âœ…' : 'âŒ'} ${key}: ${value}`);
                });
                
                const allChecksPass = Object.values(systemCheck).every(check => check === true);
                addToOutput(`ğŸ ç·åˆåˆ¤å®š: ${allChecksPass ? 'âœ… å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸ' : 'âŒ ä¸€éƒ¨ãƒ†ã‚¹ãƒˆå¤±æ•—'}`);
                
            } catch (error) {
                addToOutput('âŒ ã‚¨ãƒ©ãƒ¼: ' + error.message);
                addToOutput('ã‚¹ã‚¿ãƒƒã‚¯: ' + error.stack);
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«è‡ªå‹•å®Ÿè¡Œ
        window.addEventListener('load', () => {
            addToOutput('ğŸŒŸ ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
            setTimeout(captureConsole, 1000);
        });
    </script>
</body>
</html>