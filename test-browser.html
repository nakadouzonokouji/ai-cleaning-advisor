<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ–ãƒ©ã‚¦ã‚¶å®Ÿè¡Œãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .result { margin: 5px 0; }
        .success { color: green; }
        .error { color: red; }
        .warning { color: orange; }
    </style>
</head>
<body>
    <h1>ğŸ§ª AIæƒé™¤ã‚¢ãƒ‰ãƒã‚¤ã‚¶ãƒ¼ ãƒ–ãƒ©ã‚¦ã‚¶å®Ÿè¡Œãƒ†ã‚¹ãƒˆ</h1>
    <div id="results"></div>
    
    <script type="module">
        const results = [];
        
        function log(message, type = 'info') {
            console.log(message);
            results.push({message, type});
            updateDisplay();
        }
        
        function updateDisplay() {
            const container = document.getElementById('results');
            container.innerHTML = results.map(r => 
                `<div class="result ${r.type}">${r.message}</div>`
            ).join('');
        }
        
        async function runTests() {
            log('ğŸš€ ãƒ–ãƒ©ã‚¦ã‚¶ãƒ†ã‚¹ãƒˆé–‹å§‹', 'info');
            
            try {
                // ãƒ†ã‚¹ãƒˆ1: è¨­å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿
                log('ğŸ“¦ ãƒ†ã‚¹ãƒˆ1: è¨­å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«èª­ã¿è¾¼ã¿', 'info');
                
                const { COMPREHENSIVE_DIRT_MAPPING } = await import('./js/config/dirt-mapping.js');
                log(`âœ… DIRT_MAPPING: ${Object.keys(COMPREHENSIVE_DIRT_MAPPING).length}ä»¶`, 'success');
                
                const { COMPREHENSIVE_CLEANING_PRODUCTS } = await import('./js/config/products.js');
                log(`âœ… CLEANING_PRODUCTS: ${Object.keys(COMPREHENSIVE_CLEANING_PRODUCTS).length}ã‚«ãƒ†ã‚´ãƒª`, 'success');
                
                const { COMPREHENSIVE_LOCATION_CONFIG } = await import('./js/config/locations.js');
                log(`âœ… LOCATION_CONFIG: ${Object.keys(COMPREHENSIVE_LOCATION_CONFIG).length}å ´æ‰€`, 'success');
                
                // ãƒ†ã‚¹ãƒˆ2: APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
                log('ğŸ”Œ ãƒ†ã‚¹ãƒˆ2: APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ', 'info');
                
                const { APIClient } = await import('./js/modules/api-client.js');
                const apiClient = new APIClient();
                log('âœ… APIClient ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ', 'success');
                
                // ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨ç¢ºèª
                if (typeof apiClient.enrichProductsWithAmazonData === 'function') {
                    log('âœ… enrichProductsWithAmazonData ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨', 'success');
                } else {
                    log('âŒ enrichProductsWithAmazonData ãƒ¡ã‚½ãƒƒãƒ‰ä¸åœ¨', 'error');
                }
                
                if (typeof apiClient.getStatus === 'function') {
                    log('âœ… getStatus ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨', 'success');
                } else {
                    log('âŒ getStatus ãƒ¡ã‚½ãƒƒãƒ‰ä¸åœ¨', 'error');
                }
                
                // ãƒ†ã‚¹ãƒˆ3: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
                log('ğŸ¨ ãƒ†ã‚¹ãƒˆ3: UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ', 'info');
                
                const UIComponents = (await import('./js/modules/ui-components.js')).default;
                const uiComponents = new UIComponents();
                log('âœ… UIComponents ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ', 'success');
                
                // EventTargetç¶™æ‰¿ç¢ºèª
                if (uiComponents instanceof EventTarget) {
                    log('âœ… EventTargetç¶™æ‰¿ç¢ºèª', 'success');
                } else {
                    log('âŒ EventTargetç¶™æ‰¿ãªã—', 'error');
                }
                
                // ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨ç¢ºèª
                const uiMethods = ['on', 'emit', 'updateStatusInfo', 'showErrorMessage'];
                uiMethods.forEach(method => {
                    if (typeof uiComponents[method] === 'function') {
                        log(`âœ… UIComponents.${method} ãƒ¡ã‚½ãƒƒãƒ‰å­˜åœ¨`, 'success');
                    } else {
                        log(`âŒ UIComponents.${method} ãƒ¡ã‚½ãƒƒãƒ‰ä¸åœ¨`, 'error');
                    }
                });
                
                // ãƒ†ã‚¹ãƒˆ4: æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³
                log('ğŸ” ãƒ†ã‚¹ãƒˆ4: æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³', 'info');
                
                const RealtimeSearchEngine = (await import('./js/modules/search-engine.js')).default;
                const searchEngine = new RealtimeSearchEngine();
                log('âœ… SearchEngine ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆæˆåŠŸ', 'success');
                
                // æ¤œç´¢ãƒ†ã‚¹ãƒˆ
                const searchResults = await searchEngine.searchProductsByDirt('æ²¹æ±šã‚Œ', 'heavy', 'kitchen');
                log(`âœ… æ¤œç´¢ãƒ†ã‚¹ãƒˆçµæœ: ${searchResults.length}ä»¶`, 'success');
                
                // ãƒ†ã‚¹ãƒˆ5: ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ 
                log('ğŸ“¡ ãƒ†ã‚¹ãƒˆ5: ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ', 'info');
                
                let eventReceived = false;
                uiComponents.on('test', (event) => {
                    eventReceived = true;
                    log(`âœ… ã‚¤ãƒ™ãƒ³ãƒˆå—ä¿¡: ${event.detail}`, 'success');
                });
                
                uiComponents.emit('test', 'ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿');
                
                // å°‘ã—å¾…ã£ã¦ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†ã‚’ç¢ºèª
                setTimeout(() => {
                    if (eventReceived) {
                        log('âœ… ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ å‹•ä½œç¢ºèª', 'success');
                    } else {
                        log('âŒ ã‚¤ãƒ™ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ å‹•ä½œä¸è‰¯', 'error');
                    }
                    
                    // æœ€çµ‚çµæœ
                    log('', 'info');
                    log('ğŸ¯ ãƒ†ã‚¹ãƒˆå®Œäº†', 'info');
                    const errorCount = results.filter(r => r.type === 'error').length;
                    if (errorCount === 0) {
                        log('ğŸ‰ å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸï¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«çµ±åˆå®Œç’§', 'success');
                    } else {
                        log(`âš ï¸ ${errorCount}ä»¶ã®ã‚¨ãƒ©ãƒ¼ã‚ã‚Š`, 'warning');
                    }
                }, 100);
                
            } catch (error) {
                log(`ğŸ’¥ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼: ${error.message}`, 'error');
                console.error('è©³ç´°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }
        
        // ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
        runTests();
    </script>
</body>
</html>