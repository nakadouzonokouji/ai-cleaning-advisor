<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœ€çµ‚æ¤œè¨¼ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; line-height: 1.6; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ddd; border-radius: 8px; }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .warning { color: orange; font-weight: bold; }
        .info { color: blue; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f5f5f5; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .result { margin: 10px 0; padding: 10px; border-left: 4px solid #ddd; }
        .result.success { border-left-color: green; background: #f0fff0; }
        .result.error { border-left-color: red; background: #fff0f0; }
        .result.warning { border-left-color: orange; background: #fff8f0; }
        .asin-test { margin: 5px 0; padding: 5px; font-family: monospace; }
    </style>
</head>
<body>
    <h1>ğŸ” æœ€çµ‚æ¤œè¨¼ãƒ†ã‚¹ãƒˆ - ASINãƒ»æ©Ÿèƒ½ç·åˆãƒã‚§ãƒƒã‚¯</h1>
    
    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆ1: ASINå®Ÿåœ¨æ€§ç¢ºèª</h2>
        <button onclick="testRealASINs()">å®Ÿåœ¨ASINæ¤œè¨¼</button>
        <div id="asin-results"></div>
    </div>
    
    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆ2: ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h2>
        <button onclick="testGasIHProducts()">ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ†ã‚¹ãƒˆ</button>
        <div id="gas-ih-results"></div>
    </div>
    
    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆ3: ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</h2>
        <button onclick="testSublocationFlow()">ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</button>
        <div id="sublocation-results"></div>
    </div>
    
    <div class="test-section">
        <h2>ãƒ†ã‚¹ãƒˆ4: å•†å“ãƒªãƒ³ã‚¯ç”Ÿæˆ</h2>
        <button onclick="testProductLinks()">å•†å“ãƒªãƒ³ã‚¯ãƒ†ã‚¹ãƒˆ</button>
        <div id="link-results"></div>
    </div>

    <script src="comprehensive-cleaning-products.js"></script>
    <script src="app.js"></script>
    <script>
        // å®Ÿåœ¨ç¢ºèªæ¸ˆã¿ASINãƒªã‚¹ãƒˆ
        const VERIFIED_REAL_ASINS = [
            'B01AJQMZ5W', // èŒ‚æœ¨å’Œå“‰ æ°´å¢æ´—å‰¤
            'B00G7Y5PTO', // ã‚µãƒ³ãƒãƒ¼ãƒ« å°¿çŸ³é™¤å»
            'B07MQ6HTNB', // æ¥­å‹™ç”¨ã‚¯ã‚¨ãƒ³é…¸ã‚¯ãƒªãƒ¼ãƒŠãƒ¼
            'B079QMN7P8', // æ²¹è·äºº æ¥­å‹™ç”¨å¼·åŠ›è„±è„‚æ´—å‰¤
            'B00IH4U9ZI'  // ãƒã‚¸ãƒƒã‚¯ãƒªãƒ³ æ²¹æ±šã‚Œç”¨
        ];
        
        function testRealASINs() {
            const resultsDiv = document.getElementById('asin-results');
            
            try {
                console.log('ğŸ” ASINå®Ÿåœ¨æ€§ç¢ºèªãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const advisor = new StepWiseCleaningAdvisor();
                const productDB = advisor.getComprehensiveProductDatabase();
                
                let html = '<div class="result success">âœ… ASINæ¤œè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹</div>';
                
                const allASINs = new Set();
                
                // å…¨å•†å“ã‹ã‚‰ASINã‚’åé›†
                Object.keys(productDB).forEach(locationKey => {
                    const locationData = productDB[locationKey];
                    if (locationData.cleaners) {
                        locationData.cleaners.forEach(product => {
                            allASINs.add(product.asin);
                        });
                    }
                });
                
                html += `<div class="result info">ğŸ“Š æ¤œå‡ºã•ã‚ŒãŸASINæ•°: ${allASINs.size}å€‹</div>`;
                
                // å„ASINã®æ¤œè¨¼
                allASINs.forEach(asin => {
                    const isVerified = VERIFIED_REAL_ASINS.includes(asin);
                    const resultClass = isVerified ? 'success' : 'warning';
                    const icon = isVerified ? 'âœ…' : 'âš ï¸';
                    
                    html += `<div class="asin-test result ${resultClass}">
                        ${icon} ASIN: ${asin} - ${isVerified ? 'å®Ÿåœ¨ç¢ºèªæ¸ˆã¿' : 'è¦ç¢ºèª'}
                        <br><small>Amazon URL: https://www.amazon.co.jp/dp/${asin}</small>
                    </div>`;
                });
                
                // çµ±è¨ˆæƒ…å ±
                const verifiedCount = Array.from(allASINs).filter(asin => VERIFIED_REAL_ASINS.includes(asin)).length;
                const verificationRate = ((verifiedCount / allASINs.size) * 100).toFixed(1);
                
                html += `<div class="result ${verificationRate >= 80 ? 'success' : 'warning'}">
                    ğŸ“ˆ æ¤œè¨¼ç‡: ${verificationRate}% (${verifiedCount}/${allASINs.size})
                </div>`;
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ ASINæ¤œè¨¼ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultsDiv.innerHTML = `<div class="result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
            }
        }
        
        function testGasIHProducts() {
            const resultsDiv = document.getElementById('gas-ih-results');
            
            try {
                console.log('ğŸ”¥ ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const advisor = new StepWiseCleaningAdvisor();
                
                let html = '<div class="result success">âœ… ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ†ã‚¹ãƒˆé–‹å§‹</div>';
                
                // ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ†ã‚¹ãƒˆ
                const testCases = [
                    { location: 'kitchen_stove', level: 1, name: 'ã‚¬ã‚¹ã‚³ãƒ³ãƒ­è»½ã„æ±šã‚Œ' },
                    { location: 'kitchen_stove', level: 2, name: 'ã‚¬ã‚¹ã‚³ãƒ³ãƒ­é ‘å›ºãªæ±šã‚Œ' },
                    { location: 'kitchen_ih', level: 1, name: 'IHã‚³ãƒ³ãƒ­è»½ã„æ±šã‚Œ' },
                    { location: 'kitchen_ih', level: 2, name: 'IHã‚³ãƒ³ãƒ­é ‘å›ºãªæ±šã‚Œ' }
                ];
                
                testCases.forEach(testCase => {
                    const products = advisor.getLocationSpecificCleaners(testCase.location, testCase.level);
                    const hasProducts = Array.isArray(products) && products.length > 0;
                    
                    html += `<div class="result ${hasProducts ? 'success' : 'error'}">
                        ${hasProducts ? 'âœ…' : 'âŒ'} ${testCase.name}: ${products.length}å€‹ã®å•†å“
                    </div>`;
                    
                    if (hasProducts) {
                        products.forEach(product => {
                            const isVerified = VERIFIED_REAL_ASINS.includes(product.asin);
                            html += `<div style="margin-left: 20px; font-size: 0.9em;">
                                ${isVerified ? 'âœ…' : 'âš ï¸'} ${product.title} (${product.asin}) - Â¥${product.price}
                            </div>`;
                        });
                    }
                });
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ ã‚¬ã‚¹ã‚³ãƒ³ãƒ­ãƒ»IHå•†å“ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultsDiv.innerHTML = `<div class="result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
            }
        }
        
        function testSublocationFlow() {
            const resultsDiv = document.getElementById('sublocation-results');
            
            try {
                console.log('ğŸ¯ ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const advisor = new StepWiseCleaningAdvisor();
                
                let html = '<div class="result success">âœ… ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹</div>';
                
                // é–¢æ•°å­˜åœ¨ç¢ºèª
                const hasShowSublocation = typeof advisor.showSublocationStep === 'function';
                const hasSelectSublocation = typeof advisor.selectSublocation === 'function';
                
                html += `<div class="result ${hasShowSublocation ? 'success' : 'error'}">
                    ${hasShowSublocation ? 'âœ…' : 'âŒ'} showSublocationStep é–¢æ•°: ${hasShowSublocation}
                </div>`;
                
                html += `<div class="result ${hasSelectSublocation ? 'success' : 'error'}">
                    ${hasSelectSublocation ? 'âœ…' : 'âŒ'} selectSublocation é–¢æ•°: ${hasSelectSublocation}
                </div>`;
                
                // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¢ºèª
                const hasSelectedSublocation = advisor.hasOwnProperty('selectedSublocation');
                html += `<div class="result ${hasSelectedSublocation ? 'success' : 'error'}">
                    ${hasSelectedSublocation ? 'âœ…' : 'âŒ'} selectedSublocation ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£: ${hasSelectedSublocation}
                </div>`;
                
                // ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ ç¢ºèª
                const sublocationElements = document.querySelectorAll('[data-sublocation]');
                html += `<div class="result ${sublocationElements.length > 0 ? 'success' : 'error'}">
                    ${sublocationElements.length > 0 ? 'âœ…' : 'âŒ'} ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¦ç´ : ${sublocationElements.length}å€‹
                </div>`;
                
                // ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ±åˆãƒ†ã‚¹ãƒˆ
                advisor.selectedSublocation = 'kitchen_stove';
                const products = advisor.getLocationSpecificCleaners('kitchen', 1, 'kitchen_stove');
                const hasIntegration = Array.isArray(products) && products.length > 0;
                
                html += `<div class="result ${hasIntegration ? 'success' : 'error'}">
                    ${hasIntegration ? 'âœ…' : 'âŒ'} ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ±åˆãƒ†ã‚¹ãƒˆ: ${products.length}å€‹ã®å•†å“
                </div>`;
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ ã‚µãƒ–ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultsDiv.innerHTML = `<div class="result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
            }
        }
        
        function testProductLinks() {
            const resultsDiv = document.getElementById('link-results');
            
            try {
                console.log('ğŸ”— å•†å“ãƒªãƒ³ã‚¯ãƒ†ã‚¹ãƒˆé–‹å§‹');
                
                const advisor = new StepWiseCleaningAdvisor();
                
                let html = '<div class="result success">âœ… å•†å“ãƒªãƒ³ã‚¯ãƒ†ã‚¹ãƒˆé–‹å§‹</div>';
                
                // ãƒ†ã‚¹ãƒˆå•†å“ã®å–å¾—
                const testProducts = advisor.getLocationSpecificCleaners('kitchen_stove', 1);
                
                if (testProducts.length > 0) {
                    testProducts.forEach(product => {
                        const amazonUrl = `https://www.amazon.co.jp/dp/${product.asin}`;
                        const isValidASIN = /^B[0-9A-Z]{9}$/.test(product.asin);
                        
                        html += `<div class="result ${isValidASIN ? 'success' : 'error'}">
                            ${isValidASIN ? 'âœ…' : 'âŒ'} ${product.title}
                            <br><small>ASIN: ${product.asin}</small>
                            <br><small><a href="${amazonUrl}" target="_blank">${amazonUrl}</a></small>
                        </div>`;
                    });
                } else {
                    html += '<div class="result error">âŒ ãƒ†ã‚¹ãƒˆå•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</div>';
                }
                
                resultsDiv.innerHTML = html;
                
            } catch (error) {
                console.error('âŒ å•†å“ãƒªãƒ³ã‚¯ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼:', error);
                resultsDiv.innerHTML = `<div class="result error">âŒ ã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åŸºæœ¬ãƒã‚§ãƒƒã‚¯
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ‰ æœ€çµ‚æ¤œè¨¼ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†');
            
            // åŸºæœ¬æƒ…å ±è¡¨ç¤º
            console.log('ğŸ“Š åŸºæœ¬æƒ…å ±:');
            console.log('- StepWiseCleaningAdvisor:', typeof StepWiseCleaningAdvisor);
            console.log('- COMPREHENSIVE_CLEANING_PRODUCTS:', typeof COMPREHENSIVE_CLEANING_PRODUCTS);
            console.log('- DOMè¦ç´ æ•°:', document.querySelectorAll('*').length);
        });
    </script>
</body>
</html>